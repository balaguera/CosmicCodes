#-----------------------------------------------------------------------------------------
#PARAMETER FILE FOR COMICCODES
#-----------------------------------------------------------------------------------------
#-----------------------------------------------------------------------------------------
#-----------------------------------------------------------------------------------------
Redshift = 0.0
Initial_Redshift_SIM = 99.0
Initial_Redshift_DELTA = 99.0
IC_index = 1
Realization = 1
Unitsim_plabel = 128
#to be deprecated
Quantity = DENSITY
smscale = 0
#-----------------------------------------------------------------------------------------
#-----------------------------------------------------------------------------------------
#-----------------------------------------------------------------------------------------
# Parameters for Bias mapping techniques.
# Variables with X refere to dark matter. Variables with Y refers to tracers.
#-----------------------------------------------------------------------------------------
#Dark matter
NX = 200
iMAS_X = 1
iMAS_X_REF_PDF = 1
iMAS_X_NEW = 1
Type_of_file_X = bin
Name_Property_X = DENSITY
XNAME = DM_z
Input_Directory_X = /home/andres/data/Numerics/UNITSIM/REFERENCE/001/DM/SNAPSHOT_p128/
Input_Directory_X_REF = /home/andres/data/Numerics/UNITSIM/REFERENCE/001/DM/SNAPSHOT_p128/
Input_Directory_X_REF_TWO = /home/andres/data/Numerics/UNITSIM/REFERENCE/001_Inv/DM/SNAPSHOT_p128/
Input_Directory_X_NEW = /home/andres/data/Numerics/UNITSIM/REFERENCE/001/DM/SNAPSHOT_p128/
Input_Directory_X_new_ref = /home/andres/data/Numerics/UNITSIM/REFERENCE/001/DM/SNAPSHOT_p128/
Name_Catalog_X = dm_field_p128_Nres512_MAS1_downsampled_average.dat 
Name_Catalog_X_NEW = dm_field_p128_Nres512_MAS1_downsampled.dat
Name_Catalog_X_new_ref = dm_field_p128_Nres512_MAS1_downsampled.dat
Name_Catalog_X_REF_PDF = dm_field_p128_Nres512_MAS1_downsampled.dat
Convert_Density_to_Delta_X = true
Name_VelFieldx_X = NOFILE
Name_VelFieldy_X = NOFILE
Name_VelFieldz_X = NOFILE
Scale_X = log
delta_X_min = -1.
delta_X_max = 200.0
ldelta_X_min = 0.0
ldelta_X_max = 2.0
#-----------------------------------------------------------------------------------------
NY = 100
iMAS_Y = 0 
Type_of_file_Y = bin
Name_Property_Y = DENSITY
YNAME = TR
Input_Directory_Y = /home/andres/data/Numerics/UNITSIM/REFERENCE/001/HALOS/SNAPSHOT_p128/
Input_Directory_Y_TWO = /home/andres/data/Numerics/UNITSIM/001_Inv/HALOS/SNAPSHOT_p128/
Name_Catalog_Y = UNITSIM_HALOS_Ncounts_Nft512_MAS0.dat
Name_Property_Y = COUNTS
Name_Catalog_Y_HR =
Convert_Density_to_Delta_Y = false
Scale_Y = linear
delta_Y_min = 0.0
delta_Y_max = 100.
ldelta_Y_min = -3.0
ldelta_Y_max = 3.0
NY_MASS = 1
NY_SAT_FRAC = 1
#-----------------------------------------------------------------------------------------
Redefine_limits = false
#-----------------------------------------------------------------------------------------
#CWC analysis
Nlambdath = 0
lambdath = 0.0
lambdath_v = 0.0
N_SKNOT_MASSBIN = 100 
N_VKNOT_MASSBIN = 100 
t_CWT_used = 1 2 3 4 END #when lambdath<0, more cells are classified as knots, whence we can use knots and the rest filaments
v_CWT_used = 1 2 34 END
#-----------------------------------------------------------------------------------------
#Bias analysis
Write_PDF_number_counts = false
Comp_joint_PDF = false
Comp_conditional_PDF = false
write_files_for_histograms = false

#-----------------------------------------------------------------------------------------
#BMT parameters
N_iterations_Kernel = 400
Iterations_Kernel_average = 300
iteration_ini = 0
N_dm_realizations = 1
N_dm_initial = 1
N_iterations_dm = 0
x_OUTPUT_at_iteration = 400 END
Apply_Rankordering = false
Apply_Rankordering_ab_initio = false
l_LOS_new_dm = 1 END
Number_of_chunks_new_dm = 1
Input_Directory_BIAS_KERNEL = /home/andres/data/Numerics/UNITSIM/REFERENCE/001/CALIBRATIONS/SNAPSHOT_p128/
Input_Directory_BIAS_KERNEL_TWO = /home/andres/data/Numerics/UNITSIM/001_Inv/HALOS/SNAPSHOT_p128/

#-----------------------------------------------------------------------------------------
Output_directory = /home/andres/data/Numerics/UNITSIM/REFERENCE/001/HALOS/SNAPSHOT_p128/
#-----------------------------------------------------------------------------------------
#-----------------------------------------------------------------------------------------
#Power Spectrum
Statistics = Pk_fkp
Name_survey = UNITSIM_HALOS
Type_of_object = TRACER_REF
Input_type = density_grid
Input_type_two = density_grid
ngal_delta = 1.0
Input_dir_cat = /home/andres/data/Numerics/UNITSIM/REFERENCE/001/HALOS/SNAPSHOT_p128/
Input_dir_cat_TWO = /home/andres/data/Numerics/UNITSIM/REFERENCE/001_Inv/HALOS/SNAPSHOT_p128/
Catalogue_file = out_128p_parent.list
Catalogue_file_new_ref = out_128p_parent.list
Random_file = 
Number_of_random_files = 1
delta_grid_file = /home/andres/data/Numerics/UNITSIM/REFERENCE/001/DM/SNAPSHOT_p128/dm_field_p128_Nres512_MAS1_downsampled.dat
delta_grid_file2 =
delta_grid_file3 =
delta_grid_file4 =
measure_cross = false
measure_cross_from_1 = 1
measure_cross_from_2 = 2
# ===================================================
#Columns of ascii DM file
sys_of_coord_dm = 0
i_coord1_dm = 0
i_coord2_dm = 1
i_coord3_dm = 2
i_v1_dm = 4
i_v2_dm = 5
i_v3_dm = 6
# ===================================================
#Columns of ascii tracer file
sys_of_coord_g = 0
redshift_space_coords_g = false
angles_units_g = D
i_coord1_g = 0
i_coord2_g = 1
i_coord3_g = 2
i_v1_g = 3
i_v2_g = 4
i_v3_g = 5
vel_units_g = kmps
i_mass_g = 6
i_vmax_g = 7
i_vrms_g = 8
i_rs_g = 9
i_spin_g = 10
i_spin_bullock_g = 14
i_virial_g = 13
i_rvir_g = 15
i_b_to_a_g = 11
i_c_to_a_g = 12
i_sf_g = -1
i_color_g = -1
i_stellar_mass = -1
i_mean_density_g = -1
i_abs_mag_g = -1
i_app_mag_g = -1
i_weight1_g = -1
use_weight1_g = false
i_weight2_g = -1
use_weight1_g = false
i_weight3_g = -1
use_weight3_g = false
i_weight4_g = -1
use_weight4_g = false
weight_with_mass = false
weight_vel_with_mass = false
# ===================================================
#Columns of ascii random file
use_random_catalog = false
use_random_catalog_cl = false
nbar_tabulated = false
use_file_nbar = false
file_nbar = 
sys_of_coord_r = 2
angles_units_r = D
i_coord1_r = 1
i_coord2_r = 2
i_coord3_r = 3
i_mass_r = -1
i_color_r = -1
i_stellar_mass_r = -1
i_app_mag_r = -1
i_abs_mag_r = -1
i_mean_density_r = 4
i_weight1_r = 7
use_weight1_r = false
i_weight2_r = 15
use_weight2_r = false
i_weight3_r = 16
use_weight3_r = false
i_weight4_r = 17
use_weight4_r = false

# ===================================================
constant_depth = false
redshift_min_sample = 0.4
redshift_max_sample = 0.8
area_survey = 41253
get_window_matrix = false
i_mask_pixel = -1
i_mask_alpha = -1
i_mask_delta = -1
i_mask_flag = -1
# ===================================================
new_los = false
Lbox = 1000
Lbox_low = 1000
new_Lbox = false
xmin = 0
ymin = 0
zmin = 0
Nft = 512
Nft_HR = 1900
Nft_low = 128  # 
Nft_JK = 5  # 
mass_assignment_scheme = TSC
MAS_correction = true
type_of_binning = linear
N_log_bins = 10
DeltaKmin = 0.
ndel_data = 1
ndel_window = 1
FKP_weight = false
Pest = 20000.0
N_mu_bins = 100
SN_correction = true
FKP_error_bars = false
FKP_error_bars_exact = false
#-----------------------------------------------------------------------------------------
#Redshift histograms
N_dndz_bins = 100
new_N_dndz_bins = 60
#-----------------------------------------------------------------------------------------
file_power = 
file_power_log = 
file_window = 
file_power2d = 
file_power2d_mk = 
#-----------------------------------------------------------------------------------------
kmax_y_ds = 0.1
kmax_bk = 0.2
kmin_bk = 0
use_fundamental_mode_as_kmin_bk = false
file_bispectrum = 
#-----------------------------------------------------------------------------------------
#-----------------------------------------------------------------------------------------
#Measurements of Abundance (Mass funcito, luminosity function)
Get_Mstellar_function = false
Get_Luminosity_function = false
Get_Color_function = false
LF_estimator = Vmax_o
Get_Color_Mag_plane = false
Get_Random_Catalog = false
Nbins_color = 1
Nbins_Msterllar = 1
Mstellar_min = 0
Mstellar_max = 1
Color_min = 0
Color_max = 1
#-----------------------------------------------------------------------------------------
#-----------------------------------------------------------------------------------------



#Halo analysis
MASS_units = 1
NMASSbins_power = 4
NMASSbins = 200
LOGMASSmin = 11.301029995664 #11.4771212547197
VMAXmin = 160.0
RSmin = 1
SPINmin = 1e-5
LOGMASSmax = 16.0
VMAXmax = 1300.0
RSmax = 1200.0
SPINmax = 1.4
NMASSbins_mf = 200
NPROPbins_bam = 200 # ATENCION CON vmax_bins en def.h

#MASS BINS FOR POWER:
o_MASScuts = 12.0 13.0 END

set_bins_equal_number_tracers_main_property = false
Number_of_bins_equal_number_tracers_main_property = 5 #this is overriden if set_bins_equal_number_tracers_main_property = false

set_bins_equal_number_tracers = true
Number_of_bins_equal_number_tracers = 4

#these values (log M) are used in case Mvir is used as primary property for halo asswembly bias
m_MASSbins_min = 11.2 11.2 11.5 11.8 12.1 12.4 12.7 13.0 13.3 13.6 14.0 14.5 END  # INlcude always the full sample as the zerto-th bin
n_MASSbins_max = 15.0 11.5 11.8 12.1 12.4 12.7 13.0 13.3 13.6 14.0 14.5 15.0 END

#these values (log nu) are used in case peak height is used the primary property for halo asswembly bias
pm_PHbins_min = -0.3 -0.3 -0.2 -0.1 0.0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 END  # INlcude always the full sample as the zerto-th bin
px_PHbins_max =  0.8 -0.2 -0.1  0.0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 END

#these values (log Vmax) are used in caseVmax is used as the primary property for halo asswembly bias
a_VMAXbins_min = 1.5 1.5 1.7 1.9 2.1 2.3 2.5 2.7 2.9 3.1 END
b_VMAXbins_max = 3.3 1.7 1.9 2.1 2.3 2.5 2.7 2.9 3.1 3.3 END

#a_VMAXbins_min = 0.00 END
#b_VMAXbins_max = 1200.0 END

k_RSbins_min = 0.00 END
r_RSbins_max = 1000.0 END

q_SPINbins_min = 0.00 END
p_SPINbins_max = 20.000 END

w_VRMSbins_min = 0.00 END
z_VRMSbins_max = 1000.0 END

f_VIRbins_min = 0.0 END
g_VIRbins_max = 40.0 END

c_BTOAbins_min = 0.0 END
d_BTOAbins_max = 40.0 END

h_CTOAbins_min = 0.0 END
j_CTOAbins_max = 40.0 END

e_MACHbins_min = 0.0 END
i_MACHbins_max = 40.0 END

e_DACHbins_min = 0.0 END
i_DACHbins_max = 40.0 END


eb_BIASbins_min = -2.0 END
ib_BIASbins_max = 2.0 END

el_LCbins_min = -2.0 END
il_LCbins_max = 2.0 END

et_TAbins_min = -2.0 END
it_TAbins_max = 2.0 END

# ===================================================
#this overwrites the parameters above to do plots of bias for halo analysis
#ldelta_X_min = -1.0
#ldelta_X_max = 1.5
#ldelta_Y_min = -3.0
#ldelta_Y_max = 2.5
Nbins_hist = 200
use_real_and_redshift_space = true
Get_pearson_coefficient = false
Get_spearman_coefficient = false
Get_PCA = true
Get_marked_power_spectrum = false
Get_power_spectrum = true
Get_cross_power_spectrum = false
Get_tracer_number_counts = true
Get_tracer_mass_field = false
Get_tracer_vmax_field = false
Get_tracer_spin_field = false
Get_tracer_prop_function = false
Get_tracer_prop_function_cwt = false
Get_cell_local_mach_number = false
Get_tracer_local_mach_number = false
Get_tracer_local_dach_number = false
Get_tracer_local_dm_density = true
Scale_mach_number = 5.0
Get_local_overdensity = false
Get_tracer_bias = true
lmax_bias = 4
fracion_dilute = 0.1
Get_tracer_relative_bias = false
Get_tracer_quadratic_bias = false
kmax_tracer_bias = 0.05
kmin_tracer_bias = 0.02
kmin_tracer_qbias = 0.02
kmax_tracer_qbias = 0.08
Get_tidal_anisotropy_at_halo = false
Get_peak_height_at_halo = true
# ===================================================
# ===================================================
# ===================================================
Nbins_cf = 30
rmin_cf = 10.0
rmax_cf = 300.0
rbin_type = log
mark = mass
# ===================================================
u_PropThresholdMultiLevels = 700.0 500.0 350.0 300 250.0 END
q_NftMultiLevels = 16 32 64 128 180 END
s_PropToleranceMultiLevels = 0.95 0.9 0.9 0.8 0.7 END
Nft_random_collapse = 32
Distance_fraction = 0.35
M_exclusion = 5e13
use_vel_kernel = false
slengthv = 1.5
velbias_random = 0
velbias_dm = 0.0
# ===================================================
get_distribution_min_separations = false
# ===================================================
inputmode = 0
seed = 1
seed_ref = 0
runsim = true
runv = false
diffcosmorz = false
ic_power_file = Pk_Planck15_Table4.txt
ic_WN_file =
ic_WN_dir =
ic_file = /home/andres/data/Numerics/UNITSIM/REFERENCE/001/IC/UNITSIM_fixed_amp_L1000_Nft512_IC1_CICc.dat
use_ic_file = true
ic_input_type = delta
Normalize_IC_to_initial_redshift = false  #if IC are normalized at a z different of the initial redshift of simulation, set true
Initial_Redshift_TH_power_file = 0.0
dir = /home/andres/data/Numerics/UNITSIM/REFERENCE/001/IC/
Structure_Formation_Model = 3  # 1: ZELDOVICH; 2: 2LPT; 3: ALPT. >4: fastpm
transf = false
readPS = true
masskernel = 0 # 0: NGP, 1: CIC, 2:TSC
masskernel_vel = 1.0
slength = 10.0
velbias = 0.0
vslength = 0.0
# ===================================================
# ===================================================
file_bin_x_coord = 
file_bin_y_coord = 
file_bin_z_coord = 
N_lines_binary = 262144000
use_low_pass_filter = false
# ===================================================
Number_of_GRF = 1000
Generate_FA = false
